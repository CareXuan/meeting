# 面试问题总结1

1. nginx和php-fpm是怎么通信的？
   - 如果是127.0.0.1:9000 就是tcp socket方式进行通信 当nginx和php-fpm不在同一台机器的时候，可以通过php-fpm的ip地址和端口号进行跨服务器通信
   - 如果是php-fpm.sock 就是unix socket方式进行通信，就是通过终端进行通信，底层就是php-fpm的进程和nginx进程进行通信，这种方式配置的是php-fpm的pid文件位置，这种方式效率比tcp socket高
   - 在nginx和php-fpm配置的时候要保证都是用同一个用户和同一个组，这样不会有权限问题（一般为www-data）
   
2. B-Tree索引和B+Tree索引区别
   - B-Tree索引的值存在每一个节点上，B+Tree索引的值存在最底层叶子结点上
   - B+Tree的右子节点的第一个索引一定是他自己
   - B-Tree和B+Tree对于子节点都是索引值小的是左子节点，索引值大的是右子节点
   
3. https请求的流程

   - 先连接到443端口将请求打到服务器
   - 服务器将非对称加密公钥以证书形式回传给客户端
   - 客户端验证公钥，如果有问题请求不能继续，如果没问题客户端会随机生成一个私钥（client key），再用前面的公钥对client key进行加密发起二次http请求
   - 服务器用私钥解密，得到client key，再用client key对数据进行对称加密
   - 客户端收到密文数据后用client key进行解密得到数据后进行二次http请求

4. mysql查询语句实现对表的转置效果

   - 使用union拼接多条语句

5. redis击穿，穿透，雪崩的区别

   - 雪崩就是多点，类似零点大面积缓存失效，就是雪崩
   - 击穿是单点，对于一个热点key有高并发请求，如果这个key一消失，大量请求打到mysql
   - 穿透是指大量查询不存在的key

6. mysql事务特性

   - 原子性，一致性，隔离性，持久性
   - mysql默认的事务隔离级别是可重复读

7. 统计一个文件中ip出现次数前十（纯linux命令）

   - **sort:** 对单词进行排序

     **uniq -c:** 显示唯一的行，并在每行行首加上本行在文件中出现的次数

     **sort -kl,lnr:** 按照第一个字段，数值排序，且为逆序

     **head -10:** 取前10行数据

8. mysql中binlog的格式
   - row：只记录修改了哪行的哪些数据
   - statement：记录每次更新操作时执行的sql
   - mixed：两种模式的结合，在执行改表操作的时候会使用statement，其他修改数据操作会使用row
   
9. 加锁的原生语句是什么
   - lock in share mode 共享锁   for update 排它锁
   - 共享锁：对于一条数据如果加了锁，其他事务还能给这条数据加锁，但是只能读不能写
   - 排它锁：对于一条数据如果加了锁，其他事务就要等这个锁释放了才能继续加锁，加锁的查询操作也是不能执行的
   
10. 如果mysql新加一个从机，并且binlog丢失了，要怎么办

    - 老数据一定要通过导入导出的形式进行同步，新数据可以通过设定一个gtid（起始ID）决定同步主库binlog的起始点，在老数据同步完成后从某一个点开始继续进行主从同步

11. git回滚某一次提交的方式
    - git revert commitId
    
12. php执行一个sql的时候的流程
    - 先检查执行的用户权限
    - 查看查询池中有没有已经查询过的
    - 调用底层查询引擎进行查询
    - 写入缓存并返回结果
    
13. include和require的区别
    - include用到时加载，require一开始就加载
    - include报错不会终止程序，require报错会终止程序
    - include多次的时候每次都要读取文件，require只需要读取一次文件就可以
    
14. array_merge不会覆盖相同的值

15. redis的持久化方案

    - AOF和RDB
    - AOF是记录每一条执行的写语句（查不记录），数据完整，在redis的配置文件中配置appendonly yes，appendsync 秒即可
    - RDB是定时启动子进程形成一个快照，不影响主进程处理业务
